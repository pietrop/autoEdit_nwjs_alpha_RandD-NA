var VideoCompositor=function(e){function t(i){if(r[i])return r[i].exports;var o=r[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=[],i=!0,o=!1,a=void 0;try{for(var n,s=e[Symbol.iterator]();!(i=(n=s.next()).done)&&(r.push(n.value),!t||r.length!==t);i=!0);}catch(u){o=!0,a=u}finally{try{!i&&s["return"]&&s["return"]()}finally{if(o)throw a}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e){y.push(e)}function s(e){void 0===S&&(S=e);for(var t=(e-S)/1e3,r=0;r<y.length;r++)y[r]._update(t);S=e,requestAnimationFrame(s)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),l=r(1),c=i(l),v=r(3),f=i(v),d=r(4),h=i(d),_=r(5),p=i(_),g=r(7),m=i(g),y=[],S=void 0,T=new Map;T.set("video",c["default"]).set("image",f["default"]).set("canvas",h["default"]),s();var E=function(){function e(t,r){a(this,e),this._canvas=t,this._ctx=this._canvas.getContext("experimental-webgl",{preserveDrawingBuffer:!0,alpha:!1}),this._playing=!1,this._mediaSources=new Map,this._mediaSourcePreloadNumber=4,this._playlist=void 0,this._eventMappings=new Map,this._mediaSourceListeners=new Map,this._max_number_of_textures=this._ctx.getParameter(this._ctx.MAX_TEXTURE_IMAGE_UNITS),this._effectManager=new p["default"](this._ctx),this._audioManger=new m["default"](r),this._currentTime=0,this._playbackRate=1,this.duration=0,n(this)}return u(e,[{key:"play",value:function(){this._playing=!0,this._ctx.clearColor(0,0,0,1),this._ctx.clear(this._ctx.COLOR_BUFFER_BIT|this._ctx.DEPTH_BUFFER_BIT);var e=new CustomEvent("play",{detail:{data:this._currentTime,instance:this}});this._canvas.dispatchEvent(e)}},{key:"pause",value:function(){this._playing=!1,this._mediaSources.forEach(function(e){e.pause()});var e=new CustomEvent("pause",{detail:{data:this._currentTime,instance:this}});this._canvas.dispatchEvent(e)}},{key:"addEventListener",value:function(e,t){this._eventMappings.has(e)?this._eventMappings.get(e).push(t):this._eventMappings.set(e,[t]),this._canvas.addEventListener(e,this._dispatchEvents,!1)}},{key:"removeEventListener",value:function(e,t){if(this._eventMappings.has(e)){var r=this._eventMappings.get(e),i=r.indexOf(t);if(-1!==i)return r.splice(i,1),!0}return!1}},{key:"registerMediaSourceListener",value:function(e,t){this._mediaSourceListeners.has(e)?this._mediaSourceListeners.get(e).push(t):this._mediaSourceListeners.set(e,[t])}},{key:"unregisterMediaSourceListener",value:function(e,t){if(this._mediaSourceListeners.has(e)){var r=this._mediaSourceListeners.get(e),i=r.indexOf(t);if(i>-1&&r.splice(i,1),this._mediaSources.has(e)){var o=this._mediaSources.get(e).mediaSourceListeners;i=o.indexOf(t),i>-1&&o.splice(i,1)}return!0}return!1}},{key:"getAudioContext",value:function(){return this._audioManger.getAudioContext()}},{key:"preload",value:function(){this._playing=!0,this._update(0),this._playing=!1}},{key:"getAudioNodeForTrack",value:function(e){var t=this._audioManger.createAudioNodeFromTrack(e);return t}},{key:"_dispatchEvents",value:function(e){for(var t=0;t<e.detail.instance._eventMappings.get(e.type).length;t++)e.detail.instance._eventMappings.get(e.type)[t](e.detail.data)}},{key:"_getPlaylistPlayingStatusAtTime",value:function(e,t){for(var r=[],i=[],o=[],a=0;a<e.tracks.length;a++)for(var n=e.tracks[a],s=0;s<n.length;s++){var u=n[s],l=u.start+u.duration;t>l?o.push(u):t>u.start&&l>t?i.push(u):t<=u.start&&r.push(u)}return[r,i,o]}},{key:"_sortMediaSourcesByStartTime",value:function(e){return e.sort(function(e,t){return e.start-t.start}),e}},{key:"_loadMediaSource",value:function(e,t){void 0===t&&(t=function(){});var r=[];this._mediaSourceListeners.has(e.id)&&(r=this._mediaSourceListeners.get(e.id));var i=T.get(e.type);if(void 0===i)throw{error:5,msg:"mediaSourceReference "+e.id+" has unrecognized type "+e.type,toString:function(){return this.msg}};var o=new i(e,this._ctx);o.onready=t,o.mediaSourceListeners=r,o.load(),this._mediaSources.set(e.id,o)}},{key:"_calculateMediaSourcesOverlap",value:function(e){for(var t=0,r=void 0,i=0;i<e.length;i++){var o=e[i];o.start>t&&(t=o.start);var a=o.start+o.duration;(void 0===r||r>a)&&(r=a)}return[t,r]}},{key:"_calculateActiveTransitions",value:function(e,t){if(void 0===this._playlist||this._playing===!1)return[];if(void 0===this._playlist.transitions)return[];for(var r=[],i=0;i<e.length;i++)r.push(e[i].id);for(var a=[],n=Object.keys(this._playlist.transitions),i=0;i<n.length;i++){for(var s=n[i],u=this._playlist.transitions[s],l=!0,c=0;c<u.inputs.length;c++){var v=u.inputs[c];if(-1===r.indexOf(v)){l=!1;break}}if(l){for(var f={transition:u,transitionID:s,mediaSources:[]},c=0;c<u.inputs.length;c++)f.mediaSources.push(this._mediaSources.get(u.inputs[c]));a.push(f)}}for(var i=0;i<a.length;i++){var d=a[i].mediaSources,h=this._calculateMediaSourcesOverlap(d),_=o(h,2),p=_[0],g=_[1],m=(t-p)/(g-p);a[i].progress=m}return a}},{key:"_update",value:function(e){if(void 0!==this._playlist&&this._playing!==!1){var t=this._getPlaylistPlayingStatusAtTime(this._playlist,this._currentTime),r=o(t,3),i=r[0],a=r[1],n=r[2];if(i=this._sortMediaSourcesByStartTime(i),0===i.length&&0===a.length){this.pause();var s=new CustomEvent("ended",{detail:{data:this.currentTime,instance:this}});return this.currentTime=0,void this._canvas.dispatchEvent(s)}for(var u=0;u<this._mediaSourcePreloadNumber&&u!==i.length;u++)this._mediaSources.has(i[u].id)===!1&&this._loadMediaSource(i[u]);for(var u=0;u<n.length;u++){var l=n[u];if(this._mediaSources.has(l.id)){var c=this._mediaSources.get(l.id);c.destroy(),this._mediaSources["delete"](l.id)}}for(var v=!0,u=0;u<a.length;u++){var f=a[u].id;this._mediaSources.has(f)?this._mediaSources.get(f).isReady()||(v=!1):(this._loadMediaSource(a[u]),v=!1)}if(v!==!1){this._effectManager.updateEffects(this._playlist.effects),this._audioManger.update(this._mediaSources,a),a.reverse(),this._ctx.viewport(0,0,this._ctx.canvas.width,this._ctx.canvas.height),this._ctx.clear(this._ctx.COLOR_BUFFER_BIT|this._ctx.DEPTH_BUFFER_BIT);for(var u=0;u<a.length;u++){var f=a[u].id,c=this._mediaSources.get(f);c.play();var d=(this._currentTime-a[u].start)/a[u].duration,h={playback_rate:this._playbackRate,progress:d,duration:c.duration,source_resolution:[c.width,c.height],output_resolution:[this._canvas.width,this._canvas.height]},_=this._effectManager.getEffectForInputId(f);for(var p in _.parameters)h[p]=_.parameters[p];c.render(_.program,h,_.textures)}this._currentTime+=e*this._playbackRate}}}},{key:"playbackRate",set:function(e){("string"==typeof e||e instanceof String)&&(e=parseFloat(e)),0>e&&(e=0),this._playbackRate=e},get:function(){return this._playbackRate}},{key:"currentTime",set:function(e){if(("string"==typeof e||e instanceof String)&&(e=parseFloat(e)),console.debug("Seeking to",e),void 0!==this._playlist){var t=this._getPlaylistPlayingStatusAtTime(this._playlist,e),r=o(t,3),i=(r[0],r[1]);r[2];this._audioManger.clearAudioNodeCache(),this._mediaSources.forEach(function(e){e.destroy()}),this._mediaSources.clear();for(var a=0;a<i.length;a++){var n=i[a].id;this._mediaSources.has(n)===!1?this._loadMediaSource(i[a],function(t){t.seek(e)}):this._mediaSources.get(n).seek(e)}this._currentTime=e;var s=new CustomEvent("seek",{detail:{data:e,instance:this}});this._canvas.dispatchEvent(s)}},get:function(){return this._currentTime}},{key:"playlist",set:function(t){e.validatePlaylist(t),this.duration=e.calculatePlaylistDuration(t),this._playlist=t,this._mediaSources.forEach(function(e){e.destroy()}),this._mediaSources.clear(),this.currentTime=this._currentTime},get:function(){return this._playlist}}],[{key:"calculateTrackDuration",value:function(e){for(var t=0,r=0;r<e.length;r++){var i=e[r].start+e[r].duration;i>t&&(t=i)}return t}},{key:"calculatePlaylistDuration",value:function(t){for(var r=0,i=0;i<t.tracks.length;i++){var o=t.tracks[i],a=e.calculateTrackDuration(o);a>r&&(r=a)}return r}},{key:"validatePlaylist",value:function(e){for(var t=new Map,r=0;r<e.tracks.length;r++)for(var i=e.tracks[r],o=0;o<i.length;o++){var a=i[o];if(t.has(a.id))throw{error:1,msg:"MediaSourceReference "+a.id+" in track "+r+" has a duplicate ID.",toString:function(){return this.msg}};t.set(a.id,!0)}for(var r=0;r<e.tracks.length;r++)for(var i=e.tracks[r],o=0;o<i.length;o++){var a=i[o];if(void 0===a.id)throw{error:2,msg:"MediaSourceReference "+a.id+" in track "+r+" is missing a id property",toString:function(){return this.msg}};if(void 0===a.start)throw{error:2,msg:"MediaSourceReference "+a.id+" in track "+r+" is missing a start property",toString:function(){return this.msg}};if(void 0===a.duration)throw{error:2,msg:"MediaSourceReference "+a.id+" in track "+r+" is missing a duration property",toString:function(){return this.msg}};if(void 0===a.type)throw{error:2,msg:"MediaSourceReference "+a.id+" in track "+r+" is missing a type property",toString:function(){return this.msg}};if(void 0!==a.src&&void 0!==a.element)throw{error:2,msg:"MediaSourceReference "+a.id+" in track "+r+" has both a src and element, it must have one or the other",toString:function(){return this.msg}};if(void 0===a.src&&void 0===a.element)throw{error:2,msg:"MediaSourceReference "+a.id+" in track "+r+" has neither a src or an element, it must have one or the other",toString:function(){return this.msg}}}for(var r=0;r<e.tracks.length;r++)for(var i=e.tracks[r],n=0,o=0;o<i.length;o++){var a=i[o];if(a.start<n)throw{error:3,msg:"MediaSourceReferences "+a.id+" in track "+r+" starts before previous MediaSourceReference",toString:function(){return this.msg}};n=a.start}for(var r=0;r<e.tracks.length;r++)for(var i=e.tracks[r],s=void 0,o=0;o<i.length;o++){var a=i[o];if(void 0!==s){var u=s.start+s.duration,l=a.start;if(u>l)throw{error:4,msg:"Track MediaSourceReferences overlap. MediaSourceReference "+s.id+" in track "+r+" finishes after MediaSourceReference "+a.id+" starts.",toString:function(){return this.msg}}}else s=a}}},{key:"renderPlaylist",value:function(t,r,i){var o=r.getContext("2d"),a=r.width,n=r.height,s=n/t.tracks.length,u=e.calculatePlaylistDuration(t),l=a/u,c={video:["#572A72","#3C1255"],image:["#7D9F35","#577714"],canvas:["#AA9639","#806D15"]};o.clearRect(0,0,a,n),o.fillStyle="#999";for(var v=0;v<t.tracks.length;v++)for(var f=t.tracks[v],d=0;d<f.length;d++){var h=f[d],_=h.duration*l,p=s,g=h.start*l,m=s*v;o.fillStyle=c[h.type][d%c[h.type].length],o.fillRect(g,m,_,p),o.fill()}void 0!==i&&(o.fillStyle="#000",o.fillRect(i*l,0,1,n))}}]),e}();E.VertexShaders={DEFAULT:"        uniform float progress;        uniform float duration;        uniform vec2 source_resolution;        uniform vec2 output_resolution;        attribute vec2 a_position;        attribute vec2 a_texCoord;        varying vec2 v_texCoord;        varying float v_progress;        varying float v_duration;        varying vec2 v_source_resolution;        varying vec2 v_output_resolution;        void main() {            v_progress = progress;            v_duration = duration;            v_source_resolution = source_resolution;            v_output_resolution = output_resolution;            gl_Position = vec4(vec2(2.0,2.0)*a_position-vec2(1.0, 1.0), 0.0, 1.0);            v_texCoord = a_texCoord;        }",OFFSETSCALEINOUT:"        uniform float progress;        uniform float duration;        uniform vec2 source_resolution;        uniform vec2 output_resolution;        uniform float inTime;        uniform float outTime;        uniform float scaleX;        uniform float scaleY;        uniform float offsetX;        uniform float offsetY;        attribute vec2 a_position;        attribute vec2 a_texCoord;        varying vec2 v_texCoord;        varying float v_progress;        varying float v_duration;        varying float v_inTime;        varying float v_outTime;        varying vec2 v_source_resolution;        varying vec2 v_output_resolution;        void main() {            v_progress = progress;            v_duration = duration;            v_inTime = inTime;            v_outTime = outTime;            v_source_resolution = source_resolution;            v_output_resolution = output_resolution;            gl_Position = vec4(vec2(2.0*scaleX,2.0*scaleY)*a_position-vec2(1.0+offsetX, 1.0+offsetY), 0.0, 1.0);            v_texCoord = a_texCoord;        }",INOUT:"        uniform float progress;        uniform float duration;        uniform vec2 source_resolution;        uniform vec2 output_resolution;        uniform float inTime;        uniform float outTime;        attribute vec2 a_position;        attribute vec2 a_texCoord;        varying vec2 v_texCoord;        varying float v_progress;        varying float v_duration;        varying float v_inTime;        varying float v_outTime;        varying vec2 v_source_resolution;        varying vec2 v_output_resolution;        void main() {            v_progress = progress;            v_duration = duration;            v_inTime = inTime;            v_outTime = outTime;            v_source_resolution = source_resolution;            v_output_resolution = output_resolution;            gl_Position = vec4(vec2(2.0,2.0)*a_position-vec2(1.0, 1.0), 0.0, 1.0);            v_texCoord = a_texCoord;        }",OFFSETSCALE:"        uniform float progress;        uniform float duration;        uniform vec2 source_resolution;        uniform vec2 output_resolution;        uniform float scaleX;        uniform float scaleY;        uniform float offsetX;        uniform float offsetY;        attribute vec2 a_position;        attribute vec2 a_texCoord;        varying vec2 v_texCoord;        varying float v_progress;        varying float v_duration;        varying vec2 v_source_resolution;        varying vec2 v_output_resolution;        void main() {            v_progress = progress;            v_duration = duration;            v_source_resolution = source_resolution;            v_output_resolution = output_resolution;            gl_Position = vec4(vec2(2.0*scaleX,2.0*scaleY)*a_position-vec2(1.0+offsetX, 1.0+offsetY), 0.0, 1.0);            v_texCoord = a_texCoord;        }"},E.FragmentShaders={DEFAULT:"            precision mediump float;            uniform sampler2D u_image;            varying vec2 v_texCoord;            varying float v_progress;            varying float v_duration;            varying vec2 v_source_resolution;            varying vec2 v_output_resolution;            void main(){                gl_FragColor = texture2D(u_image, v_texCoord);            }",PRESERVEASPECTRATIO:"            precision mediump float;            uniform sampler2D u_image;            varying vec2 v_texCoord;            varying float v_progress;            varying float v_duration;            varying vec2 v_source_resolution;            varying vec2 v_output_resolution;            void main(){                float scale = 1.0;                float source_aspect_ratio = v_source_resolution[0]/v_source_resolution[1];                float output_aspect_ratio = v_output_resolution[0]/v_output_resolution[1];                if(output_aspect_ratio > source_aspect_ratio){                    scale = v_output_resolution[1]/v_source_resolution[1];                } else {                    scale = v_output_resolution[0]/v_source_resolution[0];                };                vec2 source_resolution = v_source_resolution * scale;                vec2 oCord = vec2(v_texCoord[0] * v_output_resolution[0], v_texCoord[1] * v_output_resolution[1]);                vec2 sCord = vec2(oCord[0] - (v_output_resolution[0]/2.0 - source_resolution[0]/2.0), oCord[1] - (v_output_resolution[1]/2.0 - source_resolution[1]/2.0));                if (sCord[0] < 0.0 || sCord[0] > source_resolution[0]||sCord[1] < 0.0 || sCord[1] > source_resolution[1]){                    gl_FragColor = vec4(0.0,0.0,0.0,0.0);                }else{                    gl_FragColor = texture2D(u_image, (sCord/source_resolution));                }            }",PRESERVEASPECTRATIOFILL:"            precision mediump float;            uniform sampler2D u_image;            varying vec2 v_texCoord;            varying float v_progress;            varying float v_duration;            varying vec2 v_source_resolution;            varying vec2 v_output_resolution;            void main(){                float scale = 1.0;                float source_aspect_ratio = v_source_resolution[0]/v_source_resolution[1];                float output_aspect_ratio = v_output_resolution[0]/v_output_resolution[1];                if(output_aspect_ratio > source_aspect_ratio){                    scale = v_output_resolution[1]/v_source_resolution[1];                } else {                    scale = v_output_resolution[0]/v_source_resolution[0];                };                vec2 source_resolution = v_source_resolution * scale;                vec2 oCord = vec2(v_texCoord[0] * v_output_resolution[0], v_texCoord[1] * v_output_resolution[1]);                vec2 sCord = vec2(oCord[0] - (v_output_resolution[0]/2.0 - source_resolution[0]/2.0), oCord[1] - (v_output_resolution[1]/2.0 - source_resolution[1]/2.0));                gl_FragColor = texture2D(u_image, (sCord/source_resolution));            }",MONOCHROME:"        precision mediump float;        uniform sampler2D u_image;        varying vec2 v_texCoord;        varying float v_progress;        varying vec2 v_source_resolution;        varying vec2 v_output_resolution;        void main(){            vec4 pixel = texture2D(u_image, v_texCoord);            float avg = (pixel[0]*0.2125 + pixel[1]*0.7154 + pixel[2]*0.0721)/3.0;            pixel = vec4(avg*1.5, avg*1.5, avg*1.5, pixel[3]);            gl_FragColor = pixel;        }",SEPIA:"        precision mediump float;        uniform sampler2D u_image;        varying vec2 v_texCoord;        varying float v_progress;        varying vec2 v_source_resolution;        varying vec2 v_output_resolution;        void main(){            vec4 pixel = texture2D(u_image, v_texCoord);            float avg = (pixel[0]*0.2125 + pixel[1]*0.7154 + pixel[2]*0.0721)/3.0;            pixel = vec4(avg*2.0, avg*1.6, avg, pixel[3]);            gl_FragColor = pixel;        }",BITCRUNCH:"        precision mediump float;        uniform sampler2D u_image;        varying vec2 v_texCoord;        varying float v_progress;        varying vec2 v_source_resolution;        varying vec2 v_output_resolution;        void main(){            vec4 pixel = texture2D(u_image, v_texCoord);            pixel = floor(pixel*vec4(8.0,8.0,8.0,8.0));            pixel = pixel/vec4(8.0,8.0,8.0,8.0);            gl_FragColor = pixel*vec4(1.0,1.0,1.0,1.0);        }",FADEINOUT:"        precision mediump float;        uniform sampler2D u_image;        varying vec2 v_texCoord;        varying float v_progress;        varying float v_duration;        varying float v_inTime;        varying float v_outTime;        varying vec2 v_source_resolution;        varying vec2 v_output_resolution;        void main(){            float alpha = 1.0;            if (v_progress * v_duration < v_inTime){                alpha = (v_progress * v_duration)/(v_inTime+0.001);            }            if ((v_progress * v_duration) > (v_duration - v_outTime)){                alpha = (v_outTime - ((v_progress * v_duration) - (v_duration - v_outTime)))/(v_outTime+0.001);            }            gl_FragColor = texture2D(u_image, v_texCoord) * vec4(1.0,1.0,1.0,alpha);        }",LUTSQAURE64X64:"            precision mediump float;            uniform sampler2D u_image;            uniform sampler2D lut;            varying vec2 v_texCoord;            varying float v_progress;            varying float v_duration;            varying vec2 v_source_resolution;            varying vec2 v_output_resolution;            void main(){                vec4 original_color = texture2D(u_image, v_texCoord);                original_color = clamp(original_color, vec4(0.01,0.01,0.01,0.01), vec4(0.99,0.99,0.99,0.99));                vec2 red_offset = vec2(original_color[0]/8.0 ,0.0);                vec2 green_offset = vec2(0.0,(1.0/8.0)-(original_color[1]/8.0));                                float b = floor((original_color[2] * 63.0) + 0.5);                float b_x = mod(b, 8.0);                float b_y = floor((b / 8.0) + 0.5);                vec2 blue_offset = vec2(b_x/8.0, 1.0 - b_y/8.0);                vec4 lut_color = texture2D(lut, (blue_offset + red_offset + green_offset));                gl_FragColor = lut_color;            }"},E.Effects={OFFSETSCALE:{fragmentShader:E.FragmentShaders.DEFAULT,vertexShader:E.VertexShaders.OFFSETSCALE,defaultParameters:{scaleX:1,scaleY:1,offsetX:0,offsetY:0}},MONOCHROME:{fragmentShader:E.FragmentShaders.MONOCHROME},SEPIA:{fragmentShader:E.FragmentShaders.SEPIA},BITCRUNCH:{fragmentShader:E.FragmentShaders.BITCRUNCH},GREENSCREENMAD:{fragmentShader:"            precision mediump float;            uniform sampler2D u_image;            varying vec2 v_texCoord;            varying float v_progress;            void main(){                vec4 pixel = texture2D(u_image, v_texCoord);                float alpha = 1.0;                float r = pixel[0];                float g = pixel[1];                float b = pixel[2];                float y =  0.299*r + 0.587*g + 0.114*b;                float u = -0.147*r - 0.289*g + 0.436*b;                float v =  0.615*r - 0.515*g - 0.100*b;                ;                alpha = (v+u)*10.0 +2.0;                                pixel = floor(pixel*vec4(2.0,2.0,2.0,2.0));                pixel = pixel/vec4(2.0,2.0,2.0,2.0);                pixel = vec4(pixel[2]*2.0, pixel[1]*2.0, pixel[0]*2.0, alpha);                gl_FragColor = pixel;            }"},GREENSCREEN:{fragmentShader:"            precision mediump float;            uniform sampler2D u_image;            varying vec2 v_texCoord;            varying float v_progress;            varying float v_yUpperThreshold;            varying float v_yLowerThreshold;            void main(){                vec4 pixel = texture2D(u_image, v_texCoord);                float alpha = 1.0;                float r = pixel[0];                float g = pixel[1];                float b = pixel[2];                float y =  0.299*r + 0.587*g + 0.114*b;                float u = -0.147*r - 0.289*g + 0.436*b;                float v =  0.615*r - 0.515*g - 0.100*b;                if (y > v_yLowerThreshold && y < v_yUpperThreshold){                    alpha = (v+u)*40.0 +2.0;                }                pixel = vec4(pixel[0], pixel[1], pixel[2], alpha);                gl_FragColor = pixel;            }",vertexShader:"            uniform float progress;            uniform float duration;            uniform float yLowerThreshold;            uniform float yUpperThreshold;            uniform vec2 source_resolution;            uniform vec2 output_resolution;            attribute vec2 a_position;            attribute vec2 a_texCoord;            varying vec2 v_texCoord;            varying float v_progress;            varying float v_duration;            varying float v_yLowerThreshold;            varying float v_yUpperThreshold;            varying vec2 v_source_resolution;            varying vec2 v_output_resolution;            void main() {                v_progress = progress;                v_duration = duration;                v_yLowerThreshold = yLowerThreshold;                v_yUpperThreshold = yUpperThreshold;                v_source_resolution = source_resolution;                v_output_resolution = output_resolution;                gl_Position = vec4(vec2(2.0,2.0)*a_position-vec2(1.0, 1.0), 0.0, 1.0);                v_texCoord = a_texCoord;            }",defaultParameters:{yLowerThreshold:.2,yUpperThreshold:.8}},FADEINOUT:{fragmentShader:E.FragmentShaders.FADEINOUT,vertexShader:E.VertexShaders.INOUT,defaultParameters:{inTime:1,outTime:1}},FADEINOUT1SEC:{fragmentShader:E.FragmentShaders.FADEINOUT,vertexShader:E.VertexShaders.INOUT,defaultParameters:{inTime:1,outTime:1}},FADEINOUT2SEC:{fragmentShader:E.FragmentShaders.FADEINOUT,vertexShader:E.VertexShaders.INOUT,defaultParameters:{inTime:2,outTime:2}},FADEIN1SEC:{fragmentShader:E.FragmentShaders.FADEINOUT,vertexShader:E.VertexShaders.INOUT,defaultParameters:{inTime:1,outTime:0}},FADEIN2SEC:{fragmentShader:E.FragmentShaders.FADEINOUT,vertexShader:E.VertexShaders.INOUT,defaultParameters:{inTime:2,outTime:0}},FADEOUT1SEC:{fragmentShader:E.FragmentShaders.FADEINOUT,vertexShader:E.VertexShaders.INOUT,defaultParameters:{inTime:0,outTime:1}},FADEOUT2SEC:{fragmentShader:E.FragmentShaders.FADEINOUT,vertexShader:E.VertexShaders.INOUT,defaultParameters:{inTime:0,outTime:2}},LUTSQAURE64X64:{fragmentShader:E.FragmentShaders.LUTSQAURE64X64}},t["default"]=E,e.exports=t["default"]},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}function n(e,t,r){var i=function o(e){return e.target.removeEventListener(e.type,o),r(e)};e.addEventListener(t,i,!1)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),u=function(e,t,r){for(var i=!0;i;){var o=e,a=t,n=r;s=l=u=void 0,i=!1,null===o&&(o=Function.prototype);var s=Object.getOwnPropertyDescriptor(o,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;return void 0===u?void 0:u.call(n)}var l=Object.getPrototypeOf(o);if(null===l)return void 0;e=l,t=a,r=n,i=!0}},l=r(2),c=i(l),v=function(e){function t(e,r){o(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r),this.sourceStart=0,this._volume=1,void 0!==e.sourceStart&&(this.sourceStart=e.sourceStart),void 0!==e.volume&&(this._volume=e.volume)}return a(t,e),s(t,[{key:"play",value:function(){u(Object.getPrototypeOf(t.prototype),"play",this).call(this);var e=this,r=function i(){e.element.readyState>3?(e.ready=!0,e.element.play()):(console.debug("Can't play video due to readyState"),e.ready=!1,n(e.element,"canplay",i))};r()}},{key:"seek",value:function(e){u(Object.getPrototypeOf(t.prototype),"seek",this).call(this);var r=this,i=function o(){r.element.readyState>3?(r.ready=!0,e-r.start<0||e>r.start+r.duration?r.element.currentTime=r.sourceStart:r.element.currentTime=e-r.start+r.sourceStart):(console.debug("Can't seek video due to readyState"),r.ready=!1,n(r.element,"canplay",o))};i()}},{key:"pause",value:function(){u(Object.getPrototypeOf(t.prototype),"pause",this).call(this),this.element.pause()}},{key:"load",value:function(){if(u(Object.getPrototypeOf(t.prototype),"load",this).call(this))return this.seek(0),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.element),this.ready=!0,this.width=this.element.videoWidth,this.height=this.element.videoHeight,void this.onready(this);this.element=document.createElement("video"),this.element.src=this.src,this.element.volume=this._volume,this.element.preload="auto",this.element.load();var e=this;this.element.addEventListener("loadeddata",function(){e.element.currentTime=e.sourceStart,e.seek(0),e.gl.texImage2D(e.gl.TEXTURE_2D,0,e.gl.RGBA,e.gl.RGBA,e.gl.UNSIGNED_BYTE,e.element),e.ready=!0,e.width=e.element.videoWidth,e.height=e.element.videoHeight,e.onready(e)},!1)}},{key:"render",value:function(e,r,i){this.element.playbackRate=r.playback_rate,u(Object.getPrototypeOf(t.prototype),"render",this).call(this,e,r,i)}},{key:"destroy",value:function(){this.element.pause(),this.disposeOfElementOnDestroy&&(this.element.src="",this.element.removeAttribute("src")),u(Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(c["default"]);t["default"]=v,e.exports=t["default"]},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=function(){function e(t,i){r(this,e),this.gl=i,this.id=t.id,this.duration=t.duration,this.start=t.start,this.playing=!1,this.ready=!1,this.element=void 0,this.src=void 0,this.texture=void 0,this.width=void 0,this.height=void 0,this.mediaSourceListeners=[],this.disposeOfElementOnDestroy=!1,void 0!==t.src?(this.disposeOfElementOnDestroy=!0,this.src=t.src):(this.disposeOfElementOnDestroy=!1,this.element=t.element);var o=0,a=1;i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),i.enable(i.BLEND),this.texture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this.texture),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!0),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST);var n=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,n),i.enableVertexAttribArray(o),i.vertexAttribPointer(o,2,i.FLOAT,!1,0,0),i.bufferData(i.ARRAY_BUFFER,new Float32Array([1,1,0,1,1,0,1,0,0,1,0,0]),i.STATIC_DRAW),i.enableVertexAttribArray(a),i.vertexAttribPointer(a,2,i.FLOAT,!1,0,0)}return i(e,[{key:"play",value:function(){if(this.playing===!1)for(var e=0;e<this.mediaSourceListeners.length;e++)"function"==typeof this.mediaSourceListeners[e].play&&this.mediaSourceListeners[e].play(this);this.playing=!0}},{key:"pause",value:function(){console.debug("Pausing",this.id),this.playing=!1;for(var e=0;e<this.mediaSourceListeners.length;e++)"function"==typeof this.mediaSourceListeners[e].pause&&this.mediaSourceListeners[e].pause(this)}},{key:"seek",value:function(e){for(var t=0;t<this.mediaSourceListeners.length;t++)"function"==typeof this.mediaSourceListeners[t].seek&&this.mediaSourceListeners[t].seek(this,e)}},{key:"isReady",value:function(){for(var e=!0,t=0;t<this.mediaSourceListeners.length;t++)"function"==typeof this.mediaSourceListeners[t].isReady&&this.mediaSourceListeners[t].isReady(this)===!1&&(e=!1);return e===!0&&this.ready===!0?!0:!1}},{key:"load",value:function(){console.debug("Loading",this.id);for(var e=0;e<this.mediaSourceListeners.length;e++)"function"==typeof this.mediaSourceListeners[e].load&&this.mediaSourceListeners[e].load(this);return void 0!==this.element?!0:!1}},{key:"destroy",value:function(){console.debug("Destroying",this.id);for(var e=0;e<this.mediaSourceListeners.length;e++)"function"==typeof this.mediaSourceListeners[e].destroy&&this.mediaSourceListeners[e].destroy(this);this.disposeOfElementOnDestroy&&delete this.element}},{key:"render",value:function(e,t,r){for(var i=void 0,o=0;o<this.mediaSourceListeners.length;o++)if("function"==typeof this.mediaSourceListeners[o].render){var a=this.mediaSourceListeners[o].render(this,t);void 0!==a&&(i=a)}this.gl.useProgram(e);var n=Object.keys(t),s=1;for(var u in n){var l=n[u],c=this.gl.getUniformLocation(e,l);if(-1!==c)if("number"==typeof t[l])this.gl.uniform1f(c,t[l]);else if("[object Array]"===Object.prototype.toString.call(t[l])){var v=t[l];1===v.length?this.gl.uniform1fv(c,v):2===v.length?this.gl.uniform2fv(c,v):3===v.length?this.gl.uniform3fv(c,v):4===v.length?this.gl.uniform4fv(c,v):console.debug("Shader parameter",l,"is too long and array:",v);
}else this.gl.activeTexture(this.gl.TEXTURE0+s),this.gl.uniform1i(c,s),this.gl.bindTexture(this.gl.TEXTURE_2D,r[s-1])}this.gl.activeTexture(this.gl.TEXTURE0);var f=this.gl.getUniformLocation(e,"u_image");this.gl.uniform1i(f,0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),void 0!==i?this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,i):this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.element),this.gl.drawArrays(this.gl.TRIANGLES,0,6)}},{key:"onready",value:function(e){}}]),e}();t["default"]=o,e.exports=t["default"]},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),s=function(e,t,r){for(var i=!0;i;){var o=e,a=t,n=r;s=l=u=void 0,i=!1,null===o&&(o=Function.prototype);var s=Object.getOwnPropertyDescriptor(o,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;return void 0===u?void 0:u.call(n)}var l=Object.getPrototypeOf(o);if(null===l)return void 0;e=l,t=a,r=n,i=!0}},u=r(2),l=i(u),c=function(e){function t(e,r){o(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r)}return a(t,e),n(t,[{key:"play",value:function(){s(Object.getPrototypeOf(t.prototype),"play",this).call(this)}},{key:"seek",value:function(e){s(Object.getPrototypeOf(t.prototype),"seek",this).call(this,e)}},{key:"pause",value:function(){s(Object.getPrototypeOf(t.prototype),"pause",this).call(this)}},{key:"load",value:function(){if(s(Object.getPrototypeOf(t.prototype),"load",this).call(this))return this.seek(0),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.element),this.ready=!0,this.width=this.element.width,this.height=this.element.height,void this.onready(this);this.element=new Image;var e=this;this.element.onload=function(){e.gl.texImage2D(e.gl.TEXTURE_2D,0,e.gl.RGBA,e.gl.RGBA,e.gl.UNSIGNED_BYTE,e.element),e.ready=!0,e.onready(e),e.width=e.element.width,e.height=e.element.height},this.element.src=this.src}},{key:"render",value:function(e,r,i){s(Object.getPrototypeOf(t.prototype),"render",this).call(this,e,r,i)}}]),t}(l["default"]);t["default"]=c,e.exports=t["default"]},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),s=function(e,t,r){for(var i=!0;i;){var o=e,a=t,n=r;s=l=u=void 0,i=!1,null===o&&(o=Function.prototype);var s=Object.getOwnPropertyDescriptor(o,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;return void 0===u?void 0:u.call(n)}var l=Object.getPrototypeOf(o);if(null===l)return void 0;e=l,t=a,r=n,i=!0}},u=r(2),l=i(u),c=function(e){function t(e,r){o(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,r),this.width=e.width,this.height=e.height}return a(t,e),n(t,[{key:"play",value:function(){s(Object.getPrototypeOf(t.prototype),"play",this).call(this)}},{key:"seek",value:function(e){s(Object.getPrototypeOf(t.prototype),"seek",this).call(this,e)}},{key:"pause",value:function(){s(Object.getPrototypeOf(t.prototype),"pause",this).call(this)}},{key:"load",value:function(){return s(Object.getPrototypeOf(t.prototype),"load",this).call(this)?(this.seek(0),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.element),this.ready=!0,this.width=this.element.width,this.height=this.element.height,void this.onready(this)):(this.element=document.createElement("canvas"),this.element.width=this.width,this.element.height=this.height,this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.element),this.ready=!0,void this.onready(this))}},{key:"render",value:function(e,r,i){s(Object.getPrototypeOf(t.prototype),"render",this).call(this,e,r,i)}}]),t}(l["default"]);t["default"]=c,e.exports=t["default"]},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),n=r(6),s=i(n),u=function(){function e(t){o(this,e),this.effects=new Map,this.gl=t,this.newEffect("default",{effect:{}})}return a(e,[{key:"newEffect",value:function(e,t){var r=new s["default"](t,this.gl);this.effects.set(e,r)}},{key:"updateEffects",value:function(e){if(void 0!==e)for(var t in e)this.effects.has(t)?this.effects.get(t).update(e[t]):this.newEffect(t,e[t])}},{key:"getEffectForInputId",value:function(e){var t=this.effects.keys(),r=!0,i=!1,o=void 0;try{for(var a,n=t[Symbol.iterator]();!(r=(a=n.next()).done);r=!0){var s=a.value,u=this.effects.get(s);if(u.inputs.indexOf(e)>-1)return u}}catch(l){i=!0,o=l}finally{try{!r&&n["return"]&&n["return"]()}finally{if(i)throw o}}return this.effects.get("default")}}]),e}();t["default"]=u,e.exports=t["default"]},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,r){var i=1;if(void 0!==e.parameters)for(var o=Object.keys(e.parameters),a=0;a<o.length;a++){var n=o[a],s=e.parameters[n];if("number"!=typeof s){var u=t[i-1];r.activeTexture(r.TEXTURE0+i),r.bindTexture(r.TEXTURE_2D,u),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,s),i+=1}}}function o(e,t){if(void 0===e.parameters)return[];for(var r=Object.keys(e.parameters),o=[],a=0;a<r.length;a++){var n=r[a],s=e.parameters[n];if("number"!=typeof s){var u=t.createTexture();o.push(u)}}return i(e,o,t),o}function a(e,t,r){var i=e.createShader(r);e.shaderSource(i,t),e.compileShader(i);var o=e.getShaderParameter(i,e.COMPILE_STATUS);if(!o)throw"could not compile shader:"+e.getShaderInfoLog(i);return i}function n(e,t,r){var i=a(e,t,e.VERTEX_SHADER),o=a(e,r,e.FRAGMENT_SHADER),n=e.createProgram();if(e.attachShader(n,i),e.attachShader(n,o),e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS))throw{error:4,msg:"Can't link shader program for track",toString:function(){return this.msg}};return n}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),u=function(){function e(t,i){if(r(this,e),this.gl=i,this.vertexShaderSrc=t.effect.vertexShader,void 0===this.vertexShaderSrc&&(this.vertexShaderSrc="                uniform float progress;                uniform float duration;                uniform vec2 source_resolution;                uniform vec2 output_resolution;                attribute vec2 a_position;                attribute vec2 a_texCoord;                varying vec2 v_texCoord;                varying float v_progress;                varying float v_duration;                varying vec2 v_source_resolution;                varying vec2 v_output_resolution;                void main() {                    v_progress = progress;                    v_duration = duration;                    v_source_resolution = source_resolution;                    v_output_resolution = output_resolution;                    gl_Position = vec4(vec2(2.0,2.0)*a_position-vec2(1.0, 1.0), 0.0, 1.0);                    v_texCoord = a_texCoord;                }"),this.fragmentShaderSrc=t.effect.fragmentShader,void 0===this.fragmentShaderSrc&&(this.fragmentShaderSrc="            precision mediump float;            uniform sampler2D u_image;            varying vec2 v_texCoord;            varying float v_progress;            varying float v_duration;            varying vec2 v_source_resolution;            varying vec2 v_output_resolution;            void main(){                gl_FragColor = texture2D(u_image, v_texCoord);            }"),this.parameters=t.parameters,void 0===this.parameters&&(this.parameters={}),void 0!==t.effect.defaultParameters)for(var a in t.effect.defaultParameters)void 0===this.parameters[a]&&(this.parameters[a]=t.effect.defaultParameters[a]);this.inputs=t.inputs,void 0===this.inputs&&(this.inputs=[]),this.textures=o(t,this.gl),this.program=n(this.gl,this.vertexShaderSrc,this.fragmentShaderSrc)}return s(e,[{key:"update",value:function(e){i(e,this.textures,this.gl),this.inputs=e.inputs,void 0===this.inputs&&(this.inputs=[])}}]),e}();t["default"]=u,e.exports=t["default"]},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++)if(t[r].id===e)return!0;return!1}function o(e,t){for(var r=[],o=0;o<t.length;o++){var a=t[o];i(e,a)&&r.push(o)}return r}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),n=function(){function e(t){r(this,e),this.audioCtx=t,this.tracks=[],this.audioNodes=new Map,this.audioOutputNodes=[]}return a(e,[{key:"createAudioNodeFromTrack",value:function(e){void 0===this.audioCtx&&(this.audioCtx=new AudioContext),this.tracks.push(e);var t=this.audioCtx.createGain();return this.audioOutputNodes.push(t),t}},{key:"getAudioContext",value:function(){return void 0===this.audioCtx&&(this.audioCtx=new AudioContext),this.audioCtx}},{key:"removeFromCacheById",value:function(e){var t=this.audioNodes.get(e);t.disconnect(),this.audioNodes["delete"](e)}},{key:"clearAudioNodeCache",value:function(){var e=!0,t=!1,r=void 0;try{for(var i,o=this.audioNodes.keys()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;this.removeFromCacheById(a)}}catch(n){t=!0,r=n}finally{try{!e&&o["return"]&&o["return"]()}finally{if(t)throw r}}}},{key:"update",value:function(e,t){for(var r=[],i=0;i<t.length;i++){var a=t[i];r.push(a.id)}if(void 0!==e){var n=!0,s=!1,u=void 0;try{for(var l,c=e.keys()[Symbol.iterator]();!(n=(l=c.next()).done);n=!0){var v=l.value,f=e.get(v),d=o(v,this.tracks);if(0!==d.length&&!this.audioNodes.has(v)){var h=void 0;try{h=this.audioCtx.createMediaElementSource(f.element)}catch(_){continue}this.audioNodes.set(v,h);for(var i=0;i<d.length;i++){var p=d[i];h.connect(this.audioOutputNodes[p])}}}}catch(_){s=!0,u=_}finally{try{!n&&c["return"]&&c["return"]()}finally{if(s)throw u}}}}}]),e}();t["default"]=n,e.exports=t["default"]}]);